L.Control.BingGeocoder=L.Control.extend({options:{collapsed:!0,position:"topright",text:"Locate",callback:function(a){var b=a.resourceSets[0].resources[0].bbox;a=new L.LatLng(b[0],b[1]);b=new L.LatLng(b[2],b[3]);a=new L.LatLngBounds([a,b]);this._map.fitBounds(a)}},_callbackId:0,initialize:function(a,b){this.key=a;L.Util.setOptions(this,b)},onAdd:function(a){this._map=a;a=this._container=L.DomUtil.create("div","leaflet-control-geocoder");L.DomEvent.disableClickPropagation(a);var b=this._form=L.DomUtil.create("form",
"leaflet-control-geocoder-form"),c=this._input=document.createElement("input");c.type="text";var d=document.createElement("button");d.type="submit";d.innerHTML=this.options.text;b.appendChild(c);b.appendChild(d);L.DomEvent.addListener(b,"submit",this._geocode,this);this.options.collapsed?(L.DomEvent.addListener(a,"mouseover",this._expand,this),L.DomEvent.addListener(a,"mouseout",this._collapse,this),c=this._layersLink=L.DomUtil.create("a","leaflet-control-geocoder-toggle",a),c.href="#",c.title="Bing Geocoder",
L.DomEvent.addListener(c,L.Browser.touch?"click":"focus",this._expand,this),this._map.on("movestart",this._collapse,this)):this._expand();a.appendChild(b);return a},_geocode:function(a){L.DomEvent.preventDefault(a);this._callbackId="_l_binggeocoder_"+this._callbackId++;window[this._callbackId]=L.Util.bind(this.options.callback,this);a="http://dev.virtualearth.net/REST/v1/Locations"+L.Util.getParamString({query:this._input.value,key:this.key,jsonp:this._callbackId});var b=document.createElement("script");
b.type="text/javascript";b.src=a;b.id=this._callbackId;document.getElementsByTagName("head")[0].appendChild(b)},_expand:function(){L.DomUtil.addClass(this._container,"leaflet-control-geocoder-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-geocoder-expanded","")}});